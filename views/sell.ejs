<!DOCTYPE html>
<html lang="en">
<head>
  <title>Kala-Kriti | Sell</title>
  <%- include('partials/base-head') %>
</head>
<body class="bg-gray-50">
  <!-- Set the active page for the header -->
  <% locals.page = 'sell' %>
  
  <!-- Header -->
  <%- include('partials/header') %>
  
  <!-- Sell Page Header Section -->
  <section class="bg-white py-12">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl font-semibold mb-4">Sell Your Art</h1>
        <p class="text-gray-600 text-lg">
          Share your creative vision with art enthusiasts around the world. 
          Our platform connects talented artists with collectors seeking original work.
        </p>
      </div>
    </div>
  </section>
  
  <!-- Sell Form Section -->
  <section class="py-12 bg-white">
    <div class="container mx-auto px-4">
      <div class="flex flex-col lg:flex-row gap-8 max-w-6xl mx-auto">
        <!-- Image Preview Section -->
        <div class="w-full lg:w-1/3">
          <div class="bg-gray-50 rounded-lg p-6 shadow-sm h-full">
            <h2 class="text-xl font-medium text-center mb-6">Artwork Preview</h2>
            <div class="aspect-[3/4] bg-gray-100 rounded-md mb-4 overflow-hidden flex items-center justify-center">
              <img id="art-preview" alt="Artwork Preview" class="w-full h-full object-contain hidden" />
              <div id="placeholder" class="text-gray-400 text-center p-4">
                <i class="fas fa-image text-5xl mb-2"></i>
                <p>Preview will appear here</p>
              </div>
            </div>
            <button id="preview-button" class="w-full px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium rounded-md transition-colors duration-200 mt-2 flex items-center justify-center">
              <span>Preview Upload</span>
              <i class="fa fa-rotate-right ml-2"></i>
            </button>
          </div>
        </div>
        
        <!-- Form Section -->
        <div class="w-full lg:w-2/3">
          <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
            <h2 class="text-xl font-medium mb-6 text-center">Artwork Details</h2>
            <form id="sell-art-form" method="POST" action="/artworks" class="space-y-4">
              <div>
                <label for="art-title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                <input 
                  type="text" 
                  name="title" 
                  id="art-title" 
                  placeholder="Title of your artwork" 
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                  required
                />
              </div>
              
              <div>
                <label for="art-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea 
                  name="description" 
                  id="art-description" 
                  placeholder="Describe your artwork, including style, inspiration, and techniques" 
                  rows="4" 
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                  required
                ></textarea>
              </div>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="art-dimensions" class="block text-sm font-medium text-gray-700 mb-1">Dimensions</label>
                  <input 
                    type="text" 
                    name="dimensions" 
                    id="art-dimensions" 
                    placeholder="W x H x D cm" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                    required
                  />
                </div>
                
                <div>
                  <label for="art-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                  <select 
                    name="category" 
                    id="art-category" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                    required
                  >
                    <option value="">Select a category</option>
                    <option value="painting">Painting</option>
                    <option value="sculpture">Sculpture</option>
                    <option value="photography">Photography</option>
                    <option value="digital-art">Digital Art</option>
                    <option value="mixed-media">Mixed Media</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="art-location" class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                  <input 
                    type="text" 
                    name="location" 
                    id="art-location" 
                    placeholder="City, Country" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                    required
                  />
                </div>
              </div>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="art-price" class="block text-sm font-medium text-gray-700 mb-1">Price ($)</label>
                  <input 
                    type="number" 
                    name="price" 
                    id="art-price" 
                    placeholder="Price in USD" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                    required
                  />
                </div>
                
                <div>
                  <label for="art-image-url" class="block text-sm font-medium text-gray-700 mb-1">Image URL</label>
                  <input 
                    type="url" 
                    name="imageUrl" 
                    id="art-image-url" 
                    placeholder="Link to your artwork image" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" 
                    required
                  />
                </div>
              </div>
              
              <div class="pt-4">
                <button 
                  type="submit" 
                  class="w-full px-6 py-3 bg-black text-white font-medium rounded-md hover:bg-gray-800 transition-colors duration-200"
                >
                  Submit Artwork
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Benefits Section -->
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-semibold mb-3">Why Sell With Us?</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">Join our community of artists and enjoy these benefits</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Benefit 1 -->
        <div class="bg-white rounded-lg p-8 text-center shadow-sm hover:shadow-md transition-shadow duration-300">
          <div class="text-4xl mb-4 text-gray-800 flex justify-center">
            <i class="fas fa-globe"></i>
          </div>
          <h3 class="text-xl font-medium mb-3">Global Reach</h3>
          <p class="text-gray-600">Connect with art enthusiasts and collectors from around the world who are looking for unique pieces.</p>
        </div>
        
        <!-- Benefit 2 -->
        <div class="bg-white rounded-lg p-8 text-center shadow-sm hover:shadow-md transition-shadow duration-300">
          <div class="text-4xl mb-4 text-gray-800 flex justify-center">
            <i class="fas fa-palette"></i>
          </div>
          <h3 class="text-xl font-medium mb-3">Artist Control</h3>
          <p class="text-gray-600">Set your own prices, manage your listings, and create your own artist profile to showcase your work.</p>
        </div>
        
        <!-- Benefit 3 -->
        <div class="bg-white rounded-lg p-8 text-center shadow-sm hover:shadow-md transition-shadow duration-300">
          <div class="text-4xl mb-4 text-gray-800 flex justify-center">
            <i class="fas fa-lock"></i>
          </div>
          <h3 class="text-xl font-medium mb-3">Secure Payments</h3>
          <p class="text-gray-600">Receive payments securely through our trusted payment processing system with protection for both artists and buyers.</p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Testimonials Section -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-semibold mb-3">Artist Success Stories</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">Hear from fellow artists who have found success on our platform</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
        <!-- Testimonial 1 -->
        <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
          <div class="flex items-center mb-4">
            <img src="/art/artist-1.png" alt="Sarah Johnson" class="w-12 h-12 rounded-full mr-4">
            <div>
              <h4 class="font-medium">Sarah Johnson</h4>
              <p class="text-sm text-gray-600">Contemporary Painter</p>
            </div>
          </div>
          <p class="text-gray-600 italic">"Since joining Kala-Kriti, I've connected with collectors worldwide and seen a 40% increase in my sales. The platform's support has been incredible."</p>
        </div>
        
        <!-- Testimonial 2 -->
        <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
          <div class="flex items-center mb-4">
            <img src="/art/artist-3.png" alt="Elena Rodriguez" class="w-12 h-12 rounded-full mr-4">
            <div>
              <h4 class="font-medium">Elena Rodriguez</h4>
              <p class="text-sm text-gray-600">Mixed Media Artist</p>
            </div>
          </div>
          <p class="text-gray-600 italic">"The exposure I've received through Kala-Kriti has led to gallery exhibitions and commissions I never thought possible. It's transformed my career."</p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Footer -->
  <%- include('partials/footer') %>
  
  <!-- Common Scripts -->
  <%- include('partials/base-scripts') %>
  
  <!-- Sell Page Specific Scripts -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const previewButton = document.getElementById('preview-button');
      const artPreview = document.getElementById('art-preview');
      const placeholder = document.getElementById('placeholder');
      const imageUrlInput = document.getElementById('art-image-url');
      
      previewButton.addEventListener('click', function() {
        const imageUrl = imageUrlInput.value;
        
        if (imageUrl) {
          artPreview.src = imageUrl;
          artPreview.classList.remove('hidden');
          placeholder.classList.add('hidden');
          
          // Handle image loading errors
          artPreview.onerror = function() {
            alert('Unable to load the image. Please check the URL and try again.');
            artPreview.classList.add('hidden');
            placeholder.classList.remove('hidden');
          };
        } else {
          alert('Please enter a valid image URL.');
        }
      });
      
      // Form submission handling
      const sellForm = document.getElementById('sell-art-form');
      
      sellForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = {
          title: document.getElementById('art-title').value,
          description: document.getElementById('art-description').value,
          dimensions: document.getElementById('art-dimensions').value,
          category: document.getElementById('art-category').value,
          artist: "<%= user.username %>",
          location: document.getElementById('art-location').value,
          price: document.getElementById('art-price').value,
          imageUrl: document.getElementById('art-image-url').value
        };
        
        try {
          const response = await fetch('/artworks', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
          });
          
          if (response.ok) {
            const result = await response.json();
            alert('Artwork submitted successfully!');
            window.location.href = '/artworks/' + result.artworkId;
          } else {
            const errorData = await response.text();
            let errorMessage = 'Failed to upload artwork';
            try {
              const parsedError = JSON.parse(errorData);
              errorMessage = parsedError.message || errorMessage;
            } catch (parseError) {
              // If not JSON, use text as is
              errorMessage = errorData || errorMessage;
            }
            alert(`Error: ${errorMessage}`);
          }
        } catch (error) {
          console.error('Error:', error);
          alert('An unexpected error occurred. Please try again later.');
        }
      });
    });
  </script>
</body>
</html>
